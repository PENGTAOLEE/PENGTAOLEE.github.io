---
title: 前端性能:网站加载 Waiting (TTFB) 时间过长原因和解决办法
mypath: archive
date: 2021-01-19 14:04:03
keywords:
description:
tags: 优化大师
photos:
- /archive/2021/TTFB/ttfb.jpeg
---

优化网站的时候遇到网站加载 Waiting（TTFB）时间过长的问题。这个问题的主要原因是在服务器端，不熟悉服务器运维的朋友优化起来可能会不知道从哪里下手，今天我们就从各方面分析一下网站加载 Waiting (TTFB) 时间过长的原因和解决办法。

<!-- more -->

![商城](20210119135711.jpg)

### 什么是 Waiting (TTFB) 时间
TTFB 是 Time to First Byte 的缩写，指的是浏览器开始收到服务器响应数据的时间（后台处理时间+重定向时间），是反映服务端响应速度的重要指标。简而言之，TTFB是作为客户端接收服务器响应首字节的时间。

### TTFB 时间多长算长？
因为每个服务器的硬件和网络环境都不尽相同，每个服务器的 TTFB 时间也不相同。如果想知道你的服务器可以优化到什么程度，大家可以上传一些静态的 HTML 页面到服务器，然后打开这些静态页面，看一些这些页面的 TTFB 时间，大多数服务器的 TTFB 时间都在 50 ms 以下，这个时间就是我们优化时候可以追求的时间。

### TTFB 过长的原因
我们知道，对于动态网页来说，服务器收到用户打开一个页面的请求时，首先要从数据库中读取该页面需要的数据，然后把这些数据传入到模版中，模版渲染后，再返回给用户。由于查询数据和渲染模版需要需要一定的时间，在这个过程没有完成之前，浏览器就一直处于等待接收服务器响应的状态。有些服务的性能比较低，或者优化没做好，这个时间就会比较长。
当然，如果服务器到用户之间的网络不好，服务器接收到用户请求的时间过长，也是导致 TTFB 时间过长的原因。
有时候，页面在用户的浏览器中保存了过多的 Cookie，每次请求，这些 Cookie 都要发送到服务器，服务器都要处理这些 Cookie，这也是导致 TTFB 时间过长的原因之一。

### Waiting (TTFB) 时间过长的解决办法

1. 缩短服务器响应时间，最简单直接并且有效的办法就是使用缓存，把 服务端程序 和 MySQL 的执行时间最小化，一些缓存插件可以把 SQL 查询结果缓存起来，把几十次查询结果转换为几次；一些缓存插件可以直接把用户所请求的页面静态化，用户打开网页时，相当于直接从服务器上下载了静态页面。
2. 如果是网络原因，换一个服务器是比较直接的解决办法。如果因为一些原因不能换服务器，可以使用CDN，把页面同步到离用户比较近的 CDN 节点上，也是一个不错的解决办法。
3. 如果是 Cookie 的原因，可以通过修改应用程序，删除一些不必要的 Cookie，或者精简 Cookie 内容，缩短 Cookie 的有效期等，都是解决办法。

